(()=>{function e(r){var o=n[r];if(void 0!==o)return o.exports;var s=n[r]={id:r,loaded:!1,exports:{}};return t[r].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var t={588:(e,t)=>{var n;!function(){"use strict";function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var s=typeof n;if("string"===s||"number"===s)e.push(n);else if(Array.isArray(n)){if(n.length){var i=r.apply(null,n);i&&e.push(i)}}else if("object"===s)if(n.toString===Object.prototype.toString)for(var a in n)o.call(n,a)&&n[a]&&e.push(a);else e.push(n.toString())}}return e.join(" ")}var o={}.hasOwnProperty;e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},454:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(559),t),o(n(433),t)},944:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(\.\d+)?([zZ]|((\+|-)(\d{2}):(\d{2})))$/;t.default=function(e){const t=e.match(n);if(null===t)return!1;const o=parseInt(t[1],10),s=parseInt(t[2],10),i=parseInt(t[3],10),a=parseInt(t[4],10),c=parseInt(t[5],10),l=parseInt(t[6],10);return!(s>12)&&(!(i>function(e,t){if(2===t)return(n=e)%4!=0||n%100==0&&n%400!=0?28:29;var n;return r[t]}(o,s))&&(!(a>23)&&(!(c>59)&&!(l>60))))};const r=[0,31,0,31,30,31,30,31,31,30,31,30,31]},559:function(e,t){"use strict";function n(e){return"ref"in e}function r(e){return"enum"in e}function o(e){return"elements"in e}function s(e){return"properties"in e||"optionalProperties"in e}function i(e){return"values"in e}function a(e){return"discriminator"in e}var c=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.isSchema=t.isValidSchema=t.isDiscriminatorForm=t.isValuesForm=t.isPropertiesForm=t.isElementsForm=t.isEnumForm=t.isTypeForm=t.isRefForm=t.isEmptyForm=void 0,t.isEmptyForm=function(e){const t=c(e,["definitions","nullable","metadata"]);return 0===Object.keys(t).length},t.isRefForm=n,t.isTypeForm=function(e){return"type"in e},t.isEnumForm=r,t.isElementsForm=o,t.isPropertiesForm=s,t.isValuesForm=i,t.isDiscriminatorForm=a,t.isValidSchema=function e(t,c){if(void 0===c&&(c=t),void 0!==t.definitions){if(c!==t)return!1;for(const n of Object.values(t.definitions))if(!e(n,c))return!1}if(n(t)&&!(t.ref in(c.definitions||{})))return!1;if(r(t)){if(0===t.enum.length)return!1;if(t.enum.length!==new Set(t.enum).size)return!1}if(o(t))return e(t.elements,c);if(s(t)){for(const n of Object.values(t.properties||{}))if(!e(n,c))return!1;for(const n of Object.values(t.optionalProperties||{}))if(!e(n,c))return!1;for(const e of Object.keys(t.properties||{}))if(e in(t.optionalProperties||{}))return!1}if(i(t))return e(t.values,c);if(a(t))for(const n of Object.values(t.mapping)){if(!e(n,c)||!s(n))return!1;if(n.nullable)return!1;if(t.discriminator in(n.properties||{}))return!1;if(t.discriminator in(n.optionalProperties||{}))return!1}return!0};const l=[[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!0,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!0,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!0,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!1,!1,!1,!1],[!1,!1,!1,!1,!0,!1,!0,!1,!1,!1],[!1,!1,!1,!1,!1,!0,!0,!1,!1,!1],[!1,!1,!1,!1,!0,!0,!0,!1,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!0,!1,!1],[!1,!1,!1,!1,!1,!1,!1,!1,!0,!0]],u=["boolean","float32","float64","int8","uint8","int16","uint16","int32","uint32","string","timestamp"];t.isSchema=function e(t){if("object"!=typeof t||Array.isArray(t)||null===t)return!1;const n=t,{definitions:r,nullable:o,metadata:s,ref:i,type:a,enum:h,elements:p,properties:d,optionalProperties:f,additionalProperties:_,values:v,discriminator:m,mapping:g}=n,y=c(n,["definitions","nullable","metadata","ref","type","enum","elements","properties","optionalProperties","additionalProperties","values","discriminator","mapping"]),b=[void 0!==i,void 0!==a,void 0!==h,void 0!==p,void 0!==d,void 0!==f,void 0!==_,void 0!==v,void 0!==m,void 0!==g];let C=!1;for(const e of l)C=C||e.every(((e,t)=>e===b[t]));if(!C)return!1;if(void 0!==r){if("object"!=typeof r||Array.isArray(r)||null===r)return!1;for(const t of Object.values(r))if(!e(t))return!1}if(void 0!==o&&"boolean"!=typeof o)return!1;if(void 0!==s&&("object"!=typeof s||Array.isArray(s)||null===s))return!1;if(void 0!==i&&"string"!=typeof i)return!1;if(void 0!==a&&("string"!=typeof a||!u.includes(a)))return!1;if(void 0!==h){if(!Array.isArray(h))return!1;if(!h.every((e=>"string"==typeof e)))return!1}if(void 0!==p&&!e(p))return!1;if(void 0!==d){if("object"!=typeof d||Array.isArray(d)||null===d)return!1;for(const t of Object.values(d))if(!e(t))return!1}if(void 0!==f){if("object"!=typeof f||Array.isArray(f)||null===f)return!1;for(const t of Object.values(f))if(!e(t))return!1}if(void 0!==_&&"boolean"!=typeof _)return!1;if(void 0!==v&&!e(v))return!1;if(void 0!==m&&"string"!=typeof m)return!1;if(void 0!==g){if("object"!=typeof g||Array.isArray(g)||null===g)return!1;for(const t of Object.values(g))if(!e(t))return!1}return 0===Object.keys(y).length}},433:function(e,t,n){"use strict";function r(e,t,n,u){if(!t.nullable||null!==n)if(p.isRefForm(t)){if(e.schemaTokens.length===e.config.maxDepth)throw new d;e.schemaTokens.push(["definitions",t.ref]),r(e,e.root.definitions[t.ref],n),e.schemaTokens.pop()}else if(p.isTypeForm(t)){switch(a(e,"type"),t.type){case"boolean":"boolean"!=typeof n&&l(e);break;case"float32":case"float64":"number"!=typeof n&&l(e);break;case"int8":o(e,n,-128,127);break;case"uint8":o(e,n,0,255);break;case"int16":o(e,n,-32768,32767);break;case"uint16":o(e,n,0,65535);break;case"int32":o(e,n,-2147483648,2147483647);break;case"uint32":o(e,n,0,4294967295);break;case"string":"string"!=typeof n&&l(e);break;case"timestamp":"string"!=typeof n?l(e):h.default(n)||l(e)}c(e)}else if(p.isEnumForm(t))a(e,"enum"),"string"==typeof n&&t.enum.includes(n)||l(e),c(e);else if(p.isElementsForm(t)){if(a(e,"elements"),Array.isArray(n))for(const[o,a]of n.entries())s(e,o.toString()),r(e,t.elements,a),i(e);else l(e);c(e)}else if(p.isPropertiesForm(t))if("object"!=typeof n||null===n||Array.isArray(n))a(e,void 0!==t.properties?"properties":"optionalProperties"),l(e),c(e);else{if(void 0!==t.properties){a(e,"properties");for(const[o,u]of Object.entries(t.properties))a(e,o),n.hasOwnProperty(o)?(s(e,o),r(e,u,n[o]),i(e)):l(e),c(e);c(e)}if(void 0!==t.optionalProperties){a(e,"optionalProperties");for(const[o,l]of Object.entries(t.optionalProperties))a(e,o),n.hasOwnProperty(o)&&(s(e,o),r(e,l,n[o]),i(e)),c(e);c(e)}if(!0!==t.additionalProperties)for(const r of Object.keys(n)){const n=t.optionalProperties&&r in t.optionalProperties;t.properties&&r in t.properties||n||r===u||(s(e,r),l(e),i(e))}}else if(p.isValuesForm(t)){if(a(e,"values"),"object"!=typeof n||null===n||Array.isArray(n))l(e);else for(const[o,a]of Object.entries(n))s(e,o),r(e,t.values,a),i(e);c(e)}else if(p.isDiscriminatorForm(t))if("object"!=typeof n||null===n||Array.isArray(n))a(e,"discriminator"),l(e),c(e);else if(n.hasOwnProperty(t.discriminator)){const o=n[t.discriminator];"string"==typeof o?o in t.mapping?(a(e,"mapping"),a(e,o),r(e,t.mapping[o],n,t.discriminator),c(e),c(e)):(a(e,"mapping"),s(e,t.discriminator),l(e),i(e),c(e)):(a(e,"discriminator"),s(e,t.discriminator),l(e),i(e),c(e))}else a(e,"discriminator"),l(e),c(e)}function o(e,t,n,r){("number"!=typeof t||!Number.isInteger(t)||t<n||t>r)&&l(e)}function s(e,t){e.instanceTokens.push(t)}function i(e){e.instanceTokens.pop()}function a(e,t){e.schemaTokens[e.schemaTokens.length-1].push(t)}function c(e){e.schemaTokens[e.schemaTokens.length-1].pop()}function l(e){if(e.errors.push({instancePath:[...e.instanceTokens],schemaPath:[...e.schemaTokens[e.schemaTokens.length-1]]}),e.errors.length===e.config.maxErrors)throw new f}var u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.validate=t.MaxDepthExceededError=void 0;const h=u(n(944)),p=n(559);class d extends Error{}t.MaxDepthExceededError=d;class f extends Error{}t.validate=function(e,t,n){const o={errors:[],instanceTokens:[],schemaTokens:[[]],root:e,config:n||{maxDepth:0,maxErrors:0}};try{r(o,e,t)}catch(e){if(!(e instanceof f))throw e}return o.errors}},45:(e,t,n)=>{function r(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function o(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function s(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function i(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function a(e){var t=this.__data__=new s(e);this.size=t.size}function c(e,t){var n=we(e),r=!n&&Ne(e),o=!n&&!r&&Se(e),s=!n&&!r&&!o&&Ae(e),i=n||r||o||s,a=i?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=a.length;for(var l in e)!t&&!ne.call(e,l)||i&&("length"==l||o&&("offset"==l||"parent"==l)||s&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||C(l,c))||a.push(l);return a}function l(e,t,n){(void 0!==n&&!D(e[t],n)||void 0===n&&!(t in e))&&p(e,t,n)}function u(e,t,n){var r=e[t];ne.call(e,t)&&D(r,n)&&(void 0!==n||t in e)||p(e,t,n)}function h(e,t){for(var n=e.length;n--;)if(D(e[n][0],t))return n;return-1}function p(e,t,n){"__proto__"==t&&ve?ve(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function d(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":_e&&_e in Object(e)?function(e){var t=ne.call(e,_e),n=e[_e];try{e[_e]=void 0;var r=!0}catch(e){}var o=oe.call(e);r&&(t?e[_e]=n:delete e[_e]);return o}(e):function(e){return oe.call(e)}(e)}function f(e){return w(e)&&d(e)==O}function _(e){return!(!N(e)||(t=e,re&&re in t))&&(j(e)?ie:F).test(function(e){if(null!=e){try{return te.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function v(e){if(!N(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=x(e),n=[];for(var r in e)("constructor"!=r||!t&&ne.call(e,r))&&n.push(r);return n}function m(e,t,n,r,o){e!==t&&Ee(t,(function(s,i){if(o||(o=new a),N(s))!function(e,t,n,r,o,s,i){var a=I(e,n),c=I(t,n),h=i.get(c);if(h)return void l(e,n,h);var f=s?s(a,c,n+"",e,t,i):void 0,_=void 0===f;if(_){var v=we(c),m=!v&&Se(c),g=!v&&!m&&Ae(c);f=c,v||m||g?we(a)?f=a:w(k=a)&&E(k)?f=function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(a):m?(_=!1,f=function(e,t){if(t)return e.slice();var n=e.length,r=ue?ue(n):new e.constructor(n);return e.copy(r),r}(c,!0)):g?(_=!1,y=c,b=!0?(D=new(C=y.buffer).constructor(C.byteLength),new le(D).set(new le(C)),D):y.buffer,f=new y.constructor(b,y.byteOffset,y.length)):f=[]:function(e){if(!w(e)||d(e)!=R)return!1;var t=he(e);if(null===t)return!0;var n=ne.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&te.call(n)==se}(c)||Ne(c)?(f=a,Ne(a)?f=function(e){return function(e,t,n,r){var o=!n;n||(n={});var s=-1,i=t.length;for(;++s<i;){var a=t[s],c=r?r(n[a],e[a],a,n,e):void 0;void 0===c&&(c=e[a]),o?p(n,a,c):u(n,a,c)}return n}(e,S(e))}(a):N(a)&&!j(a)||(f=function(e){return"function"!=typeof e.constructor||x(e)?{}:xe(he(e))}(c))):_=!1}var y,b,C,D;var k;_&&(i.set(c,f),o(f,c,r,s,i),i.delete(c));l(e,n,f)}(e,t,i,n,m,r,o);else{var c=r?r(I(e,i),s,i+"",e,t,o):void 0;void 0===c&&(c=s),l(e,i,c)}}),S)}function g(e,t){return ke(function(e,t,n){return t=ge(void 0===t?e.length-1:t,0),function(){for(var o=arguments,s=-1,i=ge(o.length-t,0),a=Array(i);++s<i;)a[s]=o[t+s];s=-1;for(var c=Array(t+1);++s<t;)c[s]=o[s];return c[t]=n(a),r(e,this,c)}}(e,t,A),e+"")}function y(e,t){var n,r,o=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function b(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return _(n)?n:void 0}function C(e,t){var n=typeof e;return!!(t=null==t?M:t)&&("number"==n||"symbol"!=n&&B.test(e))&&e>-1&&e%1==0&&e<t}function x(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Z)}function I(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function D(e,t){return e===t||e!=e&&t!=t}function E(e){return null!=e&&k(e.length)&&!j(e)}function j(e){if(!N(e))return!1;var t=d(e);return t==T||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function k(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=M}function N(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function w(e){return null!=e&&"object"==typeof e}function S(e){return E(e)?c(e,!0):v(e)}function A(e){return e}e=n.nmd(e);var P="__lodash_hash_undefined__",M=9007199254740991,O="[object Arguments]",T="[object Function]",R="[object Object]",F=/^\[object .+?Constructor\]$/,B=/^(?:0|[1-9]\d*)$/,L={};L["[object Float32Array]"]=L["[object Float64Array]"]=L["[object Int8Array]"]=L["[object Int16Array]"]=L["[object Int32Array]"]=L["[object Uint8Array]"]=L["[object Uint8ClampedArray]"]=L["[object Uint16Array]"]=L["[object Uint32Array]"]=!0,L[O]=L["[object Array]"]=L["[object ArrayBuffer]"]=L["[object Boolean]"]=L["[object DataView]"]=L["[object Date]"]=L["[object Error]"]=L[T]=L["[object Map]"]=L["[object Number]"]=L[R]=L["[object RegExp]"]=L["[object Set]"]=L["[object String]"]=L["[object WeakMap]"]=!1;var U,W,z,J="object"==typeof global&&global&&global.Object===Object&&global,K="object"==typeof self&&self&&self.Object===Object&&self,$=J||K||Function("return this")(),H=t&&!t.nodeType&&t,V=H&&e&&!e.nodeType&&e,q=V&&V.exports===H,X=q&&J.process,Q=function(){try{var e=V&&V.require&&V.require("util").types;return e||X&&X.binding&&X.binding("util")}catch(e){}}(),Y=Q&&Q.isTypedArray,G=Array.prototype,Z=Object.prototype,ee=$["__core-js_shared__"],te=Function.prototype.toString,ne=Z.hasOwnProperty,re=(U=/[^.]+$/.exec(ee&&ee.keys&&ee.keys.IE_PROTO||""))?"Symbol(src)_1."+U:"",oe=Z.toString,se=te.call(Object),ie=RegExp("^"+te.call(ne).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ae=q?$.Buffer:void 0,ce=$.Symbol,le=$.Uint8Array,ue=ae?ae.allocUnsafe:void 0,he=(W=Object.getPrototypeOf,z=Object,function(e){return W(z(e))}),pe=Object.create,de=Z.propertyIsEnumerable,fe=G.splice,_e=ce?ce.toStringTag:void 0,ve=function(){try{var e=b(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),me=ae?ae.isBuffer:void 0,ge=Math.max,ye=Date.now,be=b($,"Map"),Ce=b(Object,"create"),xe=function(){function e(){}return function(t){if(!N(t))return{};if(pe)return pe(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();o.prototype.clear=function(){this.__data__=Ce?Ce(null):{},this.size=0},o.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},o.prototype.get=function(e){var t=this.__data__;if(Ce){var n=t[e];return n===P?void 0:n}return ne.call(t,e)?t[e]:void 0},o.prototype.has=function(e){var t=this.__data__;return Ce?void 0!==t[e]:ne.call(t,e)},o.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ce&&void 0===t?P:t,this},s.prototype.clear=function(){this.__data__=[],this.size=0},s.prototype.delete=function(e){var t=this.__data__,n=h(t,e);return!(n<0)&&(n==t.length-1?t.pop():fe.call(t,n,1),--this.size,!0)},s.prototype.get=function(e){var t=this.__data__,n=h(t,e);return n<0?void 0:t[n][1]},s.prototype.has=function(e){return h(this.__data__,e)>-1},s.prototype.set=function(e,t){var n=this.__data__,r=h(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},i.prototype.clear=function(){this.size=0,this.__data__={hash:new o,map:new(be||s),string:new o}},i.prototype.delete=function(e){var t=y(this,e).delete(e);return this.size-=t?1:0,t},i.prototype.get=function(e){return y(this,e).get(e)},i.prototype.has=function(e){return y(this,e).has(e)},i.prototype.set=function(e,t){var n=y(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},a.prototype.clear=function(){this.__data__=new s,this.size=0},a.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},a.prototype.get=function(e){return this.__data__.get(e)},a.prototype.has=function(e){return this.__data__.has(e)},a.prototype.set=function(e,t){var n=this.__data__;if(n instanceof s){var r=n.__data__;if(!be||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new i(r)}return n.set(e,t),this.size=n.size,this};var Ie,De,Ee=function(e,t,n){for(var r=-1,o=Object(e),s=n(e),i=s.length;i--;){var a=s[Ie?i:++r];if(!1===t(o[a],a,o))break}return e},je=ve?function(e,t){return ve(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:A,ke=function(e){var t=0,n=0;return function(){var r=ye(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(je),Ne=f(function(){return arguments}())?f:function(e){return w(e)&&ne.call(e,"callee")&&!de.call(e,"callee")},we=Array.isArray,Se=me||function(){return!1},Ae=Y?function(e){return function(t){return e(t)}}(Y):function(e){return w(e)&&k(e.length)&&!!L[d(e)]},Pe=(De=function(e,t,n){m(e,t,n)},g((function(e,t){var n=-1,r=t.length,o=r>1?t[r-1]:void 0,s=r>2?t[2]:void 0;for(o=De.length>3&&"function"==typeof o?(r--,o):void 0,s&&function(e,t,n){if(!N(n))return!1;var r=typeof t;return!!("number"==r?E(n)&&C(t,n.length):"string"==r&&t in n)&&D(n[t],e)}(t[0],t[1],s)&&(o=r<3?void 0:o,r=1),e=Object(e);++n<r;){var i=t[n];i&&De(e,i,n,o)}return e})));e.exports=Pe},609:(e,t,n)=>{"use strict";function r(e,t){for(var n in t)e[n]=t[n];return e}function o(e){var t=e.parentNode;t&&t.removeChild(e)}function s(e,t,n){var r,o,s,a={};for(s in t)"key"==s?r=t[s]:"ref"==s?o=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?P.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===a[s]&&(a[s]=e.defaultProps[s]);return i(e,a,r,o,null)}function i(e,t,n,r,o){var s={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==o?++O:o};return null==o&&null!=M.vnode&&M.vnode(s),s}function a(){return{current:null}}function c(e){return e.children}function l(e,t){this.props=e,this.context=t}function u(e,t){if(null==t)return e.__?u(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?u(e):null}function h(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return h(e)}}function p(e){(!e.__d&&(e.__d=!0)&&R.push(e)&&!d.__r++||F!==M.debounceRendering)&&((F=M.debounceRendering)||setTimeout)(d)}function d(){for(var e;d.__r=R.length;)e=R.sort((function(e,t){return e.__v.__b-t.__v.__b})),R=[],e.some((function(e){var t,n,o,s,i,a;e.__d&&(i=(s=(t=e).__v).__e,(a=t.__P)&&(n=[],(o=r({},s)).__v=s.__v+1,x(a,s,o,t.__n,void 0!==a.ownerSVGElement,null!=s.__h?[i]:null,n,null==i?u(s):i,s.__h),I(n,s),s.__e!=i&&h(s)))}))}function f(e,t,n,r,o,s,a,l,h,p){var d,f,v,g,y,b,C,I=r&&r.__k||U,D=I.length;for(n.__k=[],d=0;d<t.length;d++)if(null!=(g=n.__k[d]=null==(g=t[d])||"boolean"==typeof g?null:"string"==typeof g||"number"==typeof g||"bigint"==typeof g?i(null,g,null,null,g):Array.isArray(g)?i(c,{children:g},null,null,null):g.__b>0?i(g.type,g.props,g.key,null,g.__v):g)){if(g.__=n,g.__b=n.__b+1,null===(v=I[d])||v&&g.key==v.key&&g.type===v.type)I[d]=void 0;else for(f=0;f<D;f++){if((v=I[f])&&g.key==v.key&&g.type===v.type){I[f]=void 0;break}v=null}x(e,g,v=v||L,o,s,a,l,h,p),y=g.__e,(f=g.ref)&&v.ref!=f&&(C||(C=[]),v.ref&&C.push(v.ref,null,g),C.push(f,g.__c||y,g)),null!=y?(null==b&&(b=y),"function"==typeof g.type&&g.__k===v.__k?g.__d=h=_(g,h,e):h=m(e,g,v,I,y,h),"function"==typeof n.type&&(n.__d=h)):h&&v.__e==h&&h.parentNode!=e&&(h=u(v))}for(n.__e=b,d=D;d--;)null!=I[d]&&("function"==typeof n.type&&null!=I[d].__e&&I[d].__e==n.__d&&(n.__d=u(r,d+1)),j(I[d],I[d]));if(C)for(d=0;d<C.length;d++)E(C[d],C[++d],C[++d])}function _(e,t,n){for(var r,o=e.__k,s=0;o&&s<o.length;s++)(r=o[s])&&(r.__=e,t="function"==typeof r.type?_(r,t,n):m(n,r,r,o,r.__e,t));return t}function v(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some((function(e){v(e,t)})):t.push(e)),t}function m(e,t,n,r,o,s){var i,a,c;if(void 0!==t.__d)i=t.__d,t.__d=void 0;else if(null==n||o!=s||null==o.parentNode)e:if(null==s||s.parentNode!==e)e.appendChild(o),i=null;else{for(a=s,c=0;(a=a.nextSibling)&&c<r.length;c+=2)if(a==o)break e;e.insertBefore(o,s),i=s}return void 0!==i?i:o.nextSibling}function g(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||W.test(t)?n:n+"px"}function y(e,t,n,r,o){var s;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||g(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||g(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])s=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?r||e.addEventListener(t,s?C:b,s):e.removeEventListener(t,s?C:b,s);else if("dangerouslySetInnerHTML"!==t){if(o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null!=n&&(!1!==n||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,n):e.removeAttribute(t))}}function b(e){this.l[e.type+!1](M.event?M.event(e):e)}function C(e){this.l[e.type+!0](M.event?M.event(e):e)}function x(e,t,n,o,s,i,a,u,h){var p,d,_,v,m,g,y,b,C,x,I,E,j,N=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(h=n.__h,u=t.__e=n.__e,t.__h=null,i=[u]),(p=M.__b)&&p(t);try{e:if("function"==typeof N){if(b=t.props,C=(p=N.contextType)&&o[p.__c],x=p?C?C.props.value:p.__:o,n.__c?y=(d=t.__c=n.__c).__=d.__E:("prototype"in N&&N.prototype.render?t.__c=d=new N(b,x):(t.__c=d=new l(b,x),d.constructor=N,d.render=k),C&&C.sub(d),d.props=b,d.state||(d.state={}),d.context=x,d.__n=o,_=d.__d=!0,d.__h=[]),null==d.__s&&(d.__s=d.state),null!=N.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=r({},d.__s)),r(d.__s,N.getDerivedStateFromProps(b,d.__s))),v=d.props,m=d.state,_)null==N.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==N.getDerivedStateFromProps&&b!==v&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(b,x),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(b,d.__s,x)||t.__v===n.__v){d.props=b,d.state=d.__s,t.__v!==n.__v&&(d.__d=!1),d.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),d.__h.length&&a.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(b,d.__s,x),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(v,m,g)}))}if(d.context=x,d.props=b,d.__v=t,d.__P=e,I=M.__r,E=0,"prototype"in N&&N.prototype.render)d.state=d.__s,d.__d=!1,I&&I(t),p=d.render(d.props,d.state,d.context);else do{d.__d=!1,I&&I(t),p=d.render(d.props,d.state,d.context),d.state=d.__s}while(d.__d&&++E<25);d.state=d.__s,null!=d.getChildContext&&(o=r(r({},o),d.getChildContext())),_||null==d.getSnapshotBeforeUpdate||(g=d.getSnapshotBeforeUpdate(v,m)),j=null!=p&&p.type===c&&null==p.key?p.props.children:p,f(e,Array.isArray(j)?j:[j],t,n,o,s,i,a,u,h),d.base=t.__e,t.__h=null,d.__h.length&&a.push(d),y&&(d.__E=d.__=null),d.__e=!1}else null==i&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=D(n.__e,t,n,o,s,i,a,h);(p=M.diffed)&&p(t)}catch(e){t.__v=null,(h||null!=i)&&(t.__e=u,t.__h=!!h,i[i.indexOf(u)]=null),M.__e(e,t,n)}}function I(e,t){M.__c&&M.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){M.__e(e,t.__v)}}))}function D(e,t,n,r,s,i,a,c){var l,h,p,d=n.props,_=t.props,v=t.type,m=0;if("svg"===v&&(s=!0),null!=i)for(;m<i.length;m++)if((l=i[m])&&"setAttribute"in l==!!v&&(v?l.localName===v:3===l.nodeType)){e=l,i[m]=null;break}if(null==e){if(null===v)return document.createTextNode(_);e=s?document.createElementNS("http://www.w3.org/2000/svg",v):document.createElement(v,_.is&&_),i=null,c=!1}if(null===v)d===_||c&&e.data===_||(e.data=_);else{if(i=i&&P.call(e.childNodes),h=(d=n.props||L).dangerouslySetInnerHTML,p=_.dangerouslySetInnerHTML,!c){if(null!=i)for(d={},m=0;m<e.attributes.length;m++)d[e.attributes[m].name]=e.attributes[m].value;(p||h)&&(p&&(h&&p.__html==h.__html||p.__html===e.innerHTML)||(e.innerHTML=p&&p.__html||""))}if(function(e,t,n,r,o){var s;for(s in n)"children"===s||"key"===s||s in t||y(e,s,null,n[s],r);for(s in t)o&&"function"!=typeof t[s]||"children"===s||"key"===s||"value"===s||"checked"===s||n[s]===t[s]||y(e,s,t[s],n[s],r)}(e,_,d,s,c),p)t.__k=[];else if(m=t.props.children,f(e,Array.isArray(m)?m:[m],t,n,r,s&&"foreignObject"!==v,i,a,i?i[0]:n.__k&&u(n,0),c),null!=i)for(m=i.length;m--;)null!=i[m]&&o(i[m]);c||("value"in _&&void 0!==(m=_.value)&&(m!==e.value||"progress"===v&&!m||"option"===v&&m!==d.value)&&y(e,"value",m,d.value,!1),"checked"in _&&void 0!==(m=_.checked)&&m!==e.checked&&y(e,"checked",m,d.checked,!1))}return e}function E(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){M.__e(e,n)}}function j(e,t,n){var r,s;if(M.unmount&&M.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||E(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){M.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(s=0;s<r.length;s++)r[s]&&j(r[s],t,"function"!=typeof e.type);n||null==e.__e||o(e.__e),e.__e=e.__d=void 0}function k(e,t,n){return this.constructor(e,n)}function N(e,t,n){var r,o,i;M.__&&M.__(e,t),o=(r="function"==typeof n)?null:n&&n.__k||t.__k,i=[],x(t,e=(!r&&n||t).__k=s(c,null,[e]),o||L,L,void 0!==t.ownerSVGElement,!r&&n?[n]:o?null:t.firstChild?P.call(t.childNodes):null,i,!r&&n?n:o?o.__e:t.firstChild,r),I(i,e)}function w(e,t){N(e,t,w)}function S(e,t,n){var o,s,a,c=r({},e.props);for(a in t)"key"==a?o=t[a]:"ref"==a?s=t[a]:c[a]=t[a];return arguments.length>2&&(c.children=arguments.length>3?P.call(arguments,2):n),i(e.type,c,o||e.key,s||e.ref,null)}function A(e,t){var n={__c:t="__cC"+B++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r;return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(p)},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}n.r(t),n.d(t,{Component:()=>l,Fragment:()=>c,cloneElement:()=>S,createContext:()=>A,createElement:()=>s,createRef:()=>a,h:()=>s,hydrate:()=>w,isValidElement:()=>T,options:()=>M,render:()=>N,toChildArray:()=>v});var P,M,O,T,R,F,B,L={},U=[],W=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;P=U.slice,M={__e:function(e,t,n,r){for(var o,s,i;t=t.__;)if((o=t.__c)&&!o.__)try{if((s=o.constructor)&&null!=s.getDerivedStateFromError&&(o.setState(s.getDerivedStateFromError(e)),i=o.__d),null!=o.componentDidCatch&&(o.componentDidCatch(e,r||{}),i=o.__d),i)return o.__E=o}catch(t){e=t}throw e}},O=0,T=function(e){return null!=e&&void 0===e.constructor},l.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=r({},this.state),"function"==typeof e&&(e=e(r({},n),this.props)),e&&r(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),p(this))},l.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),p(this))},l.prototype.render=c,R=[],d.__r=0,B=0},574:(e,t,n)=>{function r(e,t){for(var n in t)e[n]=t[n];return e}function o(e){this.getChildContext=function(){return{store:e.store}}}var s=n(609);o.prototype.render=function(e){return e.children&&e.children[0]||e.children},t.$=function(e,t){var n;return"function"!=typeof e&&("string"==typeof(n=e||{})&&(n=n.split(/\s*,\s*/)),e=function(e){for(var t={},r=0;r<n.length;r++)t[n[r]]=e[n[r]];return t}),function(n){function o(o,i){var a=this,c=i.store,l=e(c?c.getState():{},o),u=t?function(e,t){"function"==typeof e&&(e=e(t));var n={};for(var r in e)n[r]=t.action(e[r]);return n}(t,c):{store:c},h=function(){var t=e(c?c.getState():{},o);for(var n in t)if(t[n]!==l[n])return l=t,a.setState({});for(var r in l)if(!(r in t))return l=t,a.setState({})};this.componentWillReceiveProps=function(e){o=e,h()},this.componentDidMount=function(){c.subscribe(h)},this.componentWillUnmount=function(){c.unsubscribe(h)},this.render=function(e){return s.h(n,r(r(r({},u),e),l))}}return(o.prototype=new s.Component).constructor=o}},t.z=o}},n={};e.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";function t(e,t){for(var n in t)e[n]=t[n];return e}var n=e(609),r=e(574);const o={app:"app__JeJHz","app-pane":"app-pane__eVWfW",appPane:"app-pane__eVWfW","convos-pane":"convos-pane__T2pbX",convosPane:"convos-pane__T2pbX","messages-pane":"messages-pane__Qqipz",messagesPane:"messages-pane__Qqipz","command-box-pane":"command-box-pane__dIbHH",commandBoxPane:"command-box-pane__dIbHH","characters-pane":"characters-pane__yTeOJ",charactersPane:"characters-pane__yTeOJ"},s="command-box__X2C1t",i=new Uint32Array(2),a=()=>(crypto.getRandomValues(i),("0000000"+i[0].toString(32)).slice(-7)+("0000000"+i[1].toString(32)).slice(-7)),c=(e,t="New Character")=>{const n=a();return{chars:[...e.chars,{id:n,name:t,color:16777215}],currentCharID:n}},l=e=>({convos:[...e.convos,{messages:[],id:a(),name:"New Convo"}],currentConvoIndex:e.convos.length}),u=(e,t,n)=>{for(let r=0;r<e.convos.length;r++){const o=e.convos[r];for(let s=0;s<o.messages.length;s++){const i=o.messages[s];if(i.id===t){const t=e.convos.slice(0),a=o.messages.slice(0);return a[s]={...i,contents:n},t[r]={...o,messages:a},{convos:t}}}}return{}},h=(e,t)=>({currentCharID:t});var p=e(45),d=e.n(p);const f=function(e){function n(e){for(var t=[],n=0;n<o.length;n++)o[n]===e?e=null:t.push(o[n]);o=t}function r(n,r,s){e=r?n:t(t({},e),n);for(var i=o,a=0;a<i.length;a++)i[a](e,s)}var o=[];return e=e||{},{action:function(t){function n(e){r(e,!1,t)}return function(){for(var r=arguments,o=[e],s=0;s<arguments.length;s++)o.push(r[s]);var i=t.apply(this,o);if(null!=i)return i.then?i.then(n):n(i)}},setState:r,subscribe:function(e){return o.push(e),function(){n(e)}},unsubscribe:n,getState:function(){return e}}}((()=>{const e={version:1,projectName:"New Project",convos:[],chars:[],currentConvoIndex:-1,currentCharID:null,editedMessageID:null,editedConvoID:null,editedCharID:null,exportedConvoID:null,toBeReplacedCharID:null,insertAboveMessageID:null,exportConvoSettings:{wrapTextEnabled:!1,wrapTextLength:80,justifyEnabled:!0,justifySide:"left"}},t=localStorage.getItem("store");if(!t)return e;const n=JSON.parse(t);return 1!==n.version||d()(e,n),e})());f.subscribe((e=>{localStorage.setItem("store",JSON.stringify(e))}));const _=r.$;var v=e(609).h;const m={createMessage:(e,t,n)=>(-1===e.currentConvoIndex&&(e={...e,...l(e)}),null===e.currentCharID&&(e={...e,...c(e)}),{...e,convos:e.convos.map(((r,o)=>{if(o!==e.currentConvoIndex)return r;const s=r.messages.slice(0),i={authorID:e.currentCharID,contents:t,id:a()};return"number"==typeof n?s.splice(n,0,i):s.push(i),{...r,messages:s}}))}),editMessage:u,createCharacter:c,setCurrentCharacterID:h};const g=_(["currentCharID","chars","currentConvoIndex","convos"],m)(class extends n.Component{constructor(e){super(e),this.tabResults=null,this.tabIndex=-1,this.onKeyPress=this.onKeyPress.bind(this),this.onKeyDown=this.onKeyDown.bind(this)}onKeyDown(e){if("Tab"===e.code){e.preventDefault();const t=e.target,n=t.value.toLowerCase();if(-1===n.indexOf(":")&&null===this.tabResults&&(this.tabResults=this.props.chars.filter((e=>e.name.toLowerCase().startsWith(n))),this.tabIndex=0),!this.tabResults?.length)return;const r=this.tabResults[this.tabIndex];this.tabIndex=(this.tabIndex+1)%this.tabResults.length,t.value=`${r.name}: `}else this.tabResults=null}onKeyPress(e){if("Enter"===e.code&&!e.shiftKey){e.preventDefault();const t=e.target;let n=t.value;const r=/([^:]+):(?:\s+)(.+)/g.exec(n);if(r){const e=r[1],t=e.toLowerCase(),o=this.props.chars.find((e=>e.name.toLowerCase()===t));o?this.props.setCurrentCharacterID(o.id):this.props.createCharacter(e),n=r[2]}const o=/^s\/([^/]+)\/([^/]+)\/?$/.exec(n);if(o){const{currentCharID:e,currentConvoIndex:n,convos:r}=this.props,{messages:s}=r[n];for(let n=this.props.beforeMessage||s.length-1;n>=0;n--)if(s[n].authorID===e)return this.props.editMessage(s[n].id,s[n].contents.split(o[1]).join(o[2])),void(t.value="")}t.value="",this.props.createMessage(n,this.props.beforeMessage)}}render(){return v("textarea",{className:s,onKeyPress:this.onKeyPress,onKeyDown:this.onKeyDown})}}),y={divider:"divider__l7yCf",character:"character__atbwd",active:"active__DI5ru","character-name":"character-name__aOTHW",characterName:"character-name__aOTHW"},b="icon__l3rTB",C="icon-button__HjReh",x="disabled__GoHq2",I="delete__zP7dI",D="edit__i_k8T",E="insert-above__ENi4b",j="load__hUYQ8",k="save__iEoYK",N="export__aEQp2";var w=e(588),S=e.n(w);const A=(e,t,n)=>{const r=e.chars.findIndex((e=>e.id===t));return{chars:e.chars.filter((e=>e.id!==t)),currentCharID:n||(1===e.chars.length?null:r===e.chars.length-1?e.chars[e.chars.length-2].id:e.chars[r+1].id)}},P=(e,t)=>({editedCharID:t}),M=(e,t)=>({toBeReplacedCharID:t}),O=e=>"#"+("000000"+e.toString(16)).slice(-6);var T=e(609).h,R=e(609).Fragment;const F=({char:e,active:t,onClick:n,onEdit:r,onDelete:o})=>T("div",{className:S()(y.character,{[y.active]:t}),onClick:n&&(()=>n(e))},T("div",{className:y.characterName,style:`color: ${O(e.color)}`},e.name),T("div",{className:S()(y.edit,b,C,D),onClick:r&&(()=>r(e))}),T("div",{className:S()(y.delete,b,C,I,{[x]:!o}),onClick:o?()=>o(e):void 0})),B={deleteCharacter:A,setCurrentCharacterID:h,setEditedCharacterID:P,setToBeReplacedCharacterID:M};const L=_(["chars","currentCharID","convos","currentConvoIndex"],B)(class extends n.Component{constructor(e){super(e),this.onClickCharacter=this.onClickCharacter.bind(this),this.onEditCharacter=this.onEditCharacter.bind(this),this.onDeleteCharacter=this.onDeleteCharacter.bind(this)}onClickCharacter(e){this.props.setCurrentCharacterID(e.id)}onEditCharacter(e){this.props.setEditedCharacterID(e.id)}onDeleteCharacter(e){for(const t of this.props.convos)for(const n of t.messages)if(n.authorID===e.id)return void this.props.setToBeReplacedCharacterID(e.id);this.props.deleteCharacter(e.id)}render(){const{chars:e,currentCharID:t,convos:n,currentConvoIndex:r}=this.props,o=new Set;if(-1!==r){const e=n[r];for(const t of e.messages)o.has(t.authorID)||o.add(t.authorID)}const s=[],i=[];for(const t of e)o.has(t.id)?s.push(t):i.push(t);return T("div",{className:y.characterList},s.length>0&&T(R,null,T("div",{className:y.divider},"Characters in current convo:"),T("div",{className:y.characterSublist},s.map((e=>T(F,{key:e.id,char:e,active:e.id===t,onClick:this.onClickCharacter,onEdit:this.onEditCharacter,onDelete:this.props.chars.length>1?this.onDeleteCharacter:void 0}))))),i.length>0&&T(R,null,T("div",{className:y.divider},"Other characters:"),T("div",{className:y.characterSublist},i.map((e=>T(F,{key:e.id,char:e,active:e.id===t,onClick:this.onClickCharacter,onEdit:this.onEditCharacter,onDelete:this.props.chars.length>1?this.onDeleteCharacter:void 0}))))))}}),U="character-settings__JgFDc",W="row__zLuUf",z="label__T8d04",J="control__C6kFJ";var K=e(609).h;const $={updateCharacter:(e,t,n)=>({chars:e.chars.map((e=>e.id!==t?e:{...e,...n}))})};const H=_(["chars","editedCharID"],$)(class extends n.Component{constructor(e){super(e),this.onCharacterNameChange=this.onCharacterNameChange.bind(this),this.onCharacterColorChange=this.onCharacterColorChange.bind(this)}onCharacterNameChange(e){this.props.editedCharID&&this.props.updateCharacter(this.props.editedCharID,{name:e.target.value})}onCharacterColorChange(e){this.props.editedCharID&&this.props.updateCharacter(this.props.editedCharID,{color:parseInt(e.target.value.slice(1),16)})}render(){const{editedCharID:e,chars:t}=this.props,n=t.find((t=>t.id===e));return n?K("div",{className:U},K("div",{className:W},K("div",{className:z},"Character name"),K("input",{type:"text",className:J,value:n.name,onChange:this.onCharacterNameChange})),K("div",{className:W},K("div",{className:z},"Character color"),K("input",{type:"color",className:J,value:O(n.color),onChange:this.onCharacterColorChange}))):null}}),V="convo-list__j6Sov",q="convos__BRQXe",X="convo__bZVJO",Q="active__JExB6",Y="convo-name__c8nBG",G="add-convo-wrapper__U_hhq",Z=(e,t)=>({exportedConvoID:t});var ee=e(609).h;const te={createConvo:l,setCurrentConvoIndex:(e,t)=>({currentConvoIndex:t}),setEditedConvo:(e,t)=>({editedConvoID:void 0===t?e.convos[e.currentConvoIndex].id:t}),setConvoName:(e,t,n)=>({convos:e.convos.map((e=>e.id!==t?e:{...e,name:n}))}),deleteConvo:(e,t)=>({convos:e.convos.filter(((e,n)=>n!==t)),currentConvoIndex:1===e.convos.length?-1:e.currentConvoIndex===e.convos.length-1?e.currentConvoIndex-1:e.currentConvoIndex}),setExportedConvoID:Z};const ne=_(["convos","currentConvoIndex","editedConvoID"],te)(class extends n.Component{constructor(e){super(e),this.onAddConvo=this.onAddConvo.bind(this),this.onEditConvo=this.onEditConvo.bind(this),this.onExportConvo=this.onExportConvo.bind(this),this.onConvoEditKeyPress=this.onConvoEditKeyPress.bind(this),this.onConvoEditBlur=this.onConvoEditBlur.bind(this),this.editedConvoRef=(0,n.createRef)()}onAddConvo(){this.props.createConvo(),this.props.setEditedConvo()}onClickConvo(e){this.props.setCurrentConvoIndex(e)}onExportConvo(e,t){t.stopPropagation(),this.props.setExportedConvoID(e)}onEditConvo(e,t){t.stopPropagation(),this.props.setEditedConvo(e)}onDeleteConvo(e,t){t.stopPropagation(),this.props.deleteConvo(e)}onConvoEditKeyPress(e){"Enter"===e.code&&this.props.setEditedConvo(null)}onConvoEditBlur(){this.props.setEditedConvo(null)}updateConvoName(e,t){this.props.setConvoName(e,t.target.value)}componentDidUpdate(e){this.props.editedConvoID&&e.editedConvoID!==this.props.editedConvoID&&this.editedConvoRef.current&&(this.editedConvoRef.current.focus(),this.editedConvoRef.current.select())}render(){const{convos:e,currentConvoIndex:t}=this.props;return ee("div",{className:V},ee("div",{className:q},e.map(((e,n)=>ee("div",{className:S()(X,{[Q]:t===n}),key:e.id,onClick:this.onClickConvo.bind(this,n)},ee("div",{className:Y},this.props.editedConvoID===e.id?ee("input",{type:"text",value:e.name,onInput:this.updateConvoName.bind(this,e.id),onKeyPress:this.onConvoEditKeyPress,onBlur:this.onConvoEditBlur,ref:this.editedConvoRef}):e.name),ee("div",{className:S()(b,C,N),onClick:this.onExportConvo.bind(this,e.id)}),ee("div",{className:S()(b,C,D),onClick:this.onEditConvo.bind(this,e.id)}),ee("div",{className:S()(b,C,I),onClick:this.onDeleteConvo.bind(this,n)}))))),ee("div",{className:G},ee("button",{onClick:this.onAddConvo},"Add Convo")))}}),re={"export-title":"export-title__Kqtsy",exportTitle:"export-title__Kqtsy",row:"row__cbCwA"},oe=(e,t)=>{const n=document.createElement("a"),r=URL.createObjectURL(new Blob([t]));n.href=r,n.download=e,n.click(),setTimeout((()=>{window.URL.revokeObjectURL(r)}),0)};var se=e(609).h;const ie={setWrapTextEnabled:(e,t)=>({exportConvoSettings:{...e.exportConvoSettings,wrapTextEnabled:t}}),setWrapTextLength:(e,t)=>({exportConvoSettings:{...e.exportConvoSettings,wrapTextLength:t}}),setJustifyEnabled:(e,t)=>({exportConvoSettings:{...e.exportConvoSettings,justifyEnabled:t}}),setJustifySide:(e,t)=>({exportConvoSettings:{...e.exportConvoSettings,justifySide:t}})};const ae=_((e=>{const{convos:t,exportedConvoID:n,chars:r}=e,{wrapTextEnabled:o,wrapTextLength:s,justifyEnabled:i,justifySide:a}=e.exportConvoSettings;return{convos:t,exportedConvoID:n,chars:r,wrapTextEnabled:o,wrapTextLength:s,justifyEnabled:i,justifySide:a}}),ie)(class extends n.Component{constructor(e){super(e),this.onChangeWrapTextEnabled=this.onChangeWrapTextEnabled.bind(this),this.onChangeWrapTextLength=this.onChangeWrapTextLength.bind(this),this.onChangeJustifyEnabled=this.onChangeJustifyEnabled.bind(this),this.onChangeJustifySide=this.onChangeJustifySide.bind(this),this.onExport=this.onExport.bind(this)}onChangeWrapTextEnabled(e){this.props.setWrapTextEnabled(e.target.checked)}onChangeWrapTextLength(e){const t=parseInt(e.target.value);Number.isFinite(t)&&this.props.setWrapTextLength(t)}onChangeJustifyEnabled(e){this.props.setJustifyEnabled(e.target.checked)}onChangeJustifySide(e){this.props.setJustifySide(e.target.value)}onExport(){const{convos:e,exportedConvoID:t,chars:n,wrapTextEnabled:r,wrapTextLength:o,justifyEnabled:s,justifySide:i}=this.props,a=e.find((e=>e.id===t));if(!a)return;const c=new Set;for(const e of a.messages)c.add(e.authorID);const l=Array.from(c).reduce(((e,t)=>Math.max(e,n.find((e=>e.id===t))?.name.length??0)),0),u=[];for(const e of a.messages){const t=n.find((t=>t.id===e.authorID))?.name??"Unknown character";let a=`<${t}> `;if(s){const e=" ".repeat(l-t.length);"left"===i?a+=e:a=e+a}let c=a;if(r){const t=/([^\s]+)(\s|$)/g;let n;for(t.lastIndex=0;null!==(n=t.exec(e.contents));)c.length+n[1].length<=o?c+=n[0]:(u.push(c.trimEnd()),c=" ".repeat(a.length)+n[0]);c.trimEnd().length>0&&u.push(c.trimEnd())}else u.push(c+e.contents)}const h=u.join("\n");oe(`${a.name}.txt`,h)}render(){const{convos:e,exportedConvoID:t,wrapTextEnabled:n,wrapTextLength:r,justifyEnabled:o,justifySide:s}=this.props,i=e.find((e=>e.id===t));return i?se("div",{className:re.exportModal},se("div",{className:re.exportTitle},"Export ",`"${i.name}"`),se("div",{className:re.row},se("label",null,se("input",{type:"checkbox",checked:n,onChange:this.onChangeWrapTextEnabled}),"Wrap text at "),se("input",{type:"number",min:0,onChange:this.onChangeWrapTextLength,disabled:!n,value:r})," chars"),se("div",{className:re.row},se("label",null,se("input",{type:"checkbox",checked:o,onChange:this.onChangeJustifyEnabled}),"Justify usernames "),se("label",null,se("input",{type:"radio",onClick:this.onChangeJustifySide,checked:"left"===s,disabled:!o,value:"left"})," Left"),se("label",null,se("input",{type:"radio",onClick:this.onChangeJustifySide,checked:"right"===s,disabled:!o,value:"right"})," Right")),se("div",{className:re.row},se("button",{onClick:this.onExport},"Export"))):null}}),ce="messages__QvVmW",le="messages-inner__T5ymp",ue="insert-box__BVqQD",he="close-wrapper__Lige8",pe="close-positioner__F_Vfd",de="command-box-wrapper__dWK1s",fe={message:"message__uH2iI",buttons:"buttons__tpv1D",contents:"contents__bXbLz",author:"author__bTxVP","message-edit-wrapper":"message-edit-wrapper__Uq_as",messageEditWrapper:"message-edit-wrapper__Uq_as","message-edit-area":"message-edit-area__UcstZ",messageEditArea:"message-edit-area__UcstZ"},_e="searchable-menu__MRzCU",ve="search-bar__lDaLX",me="items__BvMBg",ge="item__YnleD";var ye=e(609).h;const be=class extends n.Component{constructor(e){super(e),this.state={query:"",maxHeight:null,y:null},this.onInput=this.onInput.bind(this),this.onFocusOut=this.onFocusOut.bind(this),this.searchRef=(0,n.createRef)()}onInput(e){this.setState({query:e.target.value})}onFocusOut(e){!e.currentTarget.contains(e.relatedTarget)&&this.props.onDismiss&&this.props.onDismiss()}componentDidMount(){this.searchRef.current&&this.searchRef.current.focus()}render(){return ye("div",{className:_e,style:{top:`${this.props.y}px`,left:`${this.props.x}px`,maxHeight:`calc(100vh - ${this.props.y}px)`},onfocusout:this.onFocusOut,tabIndex:0},ye("div",{className:ve},ye("input",{type:"text",onInput:this.onInput,ref:this.searchRef})),ye("div",{className:me},this.props.items.map((e=>-1===e.value.toLowerCase().indexOf(this.state.query)?null:ye("div",{className:ge,key:e.id,onClick:this.props.onClickItem?this.props.onClickItem.bind(this,e.id):void 0},e.value)))))}},Ce=(e,t)=>({insertAboveMessageID:t});var xe=e(609).h;const Ie={deleteMessage:(e,t)=>({convos:e.convos.map(((n,r)=>r!==e.currentConvoIndex?n:{...n,messages:n.messages.filter(((e,n)=>n!==t))}))}),editMessage:u,replaceMessageAuthor:(e,t,n)=>{for(let r=0;r<e.convos.length;r++){const o=e.convos[r];for(let s=0;s<o.messages.length;s++){const i=o.messages[s];if(i.id===t){const t=e.convos.slice(0),a=o.messages.slice(0);return a[s]={...i,authorID:n},t[r]={...o,messages:a},{convos:t}}}}return{}},setEditedMessage:(e,t)=>({editedMessageID:t}),setInsertAboveMessageID:Ce};const De=_(["chars","editedMessageID","insertAboveMessageID"],Ie)(class extends n.Component{constructor(e){super(e),this.state={authorMenuOpen:!1,authorMenuX:0,authorMenuY:0},this.contentsRef=(0,n.createRef)(),this.onInsertAbove=this.onInsertAbove.bind(this),this.onMessageEdit=this.onMessageEdit.bind(this),this.onMessageDelete=this.onMessageDelete.bind(this),this.onKeyPress=this.onKeyPress.bind(this),this.onBlur=this.onBlur.bind(this),this.onClickAuthor=this.onClickAuthor.bind(this),this.onDismissAuthorMenu=this.onDismissAuthorMenu.bind(this),this.onReplaceAuthor=this.onReplaceAuthor.bind(this)}onInsertAbove(){this.props.setInsertAboveMessageID(this.props.insertAboveMessageID===this.props.message.id?null:this.props.message.id)}onMessageEdit(){this.props.setEditedMessage(this.props.editedMessageID===this.props.message.id?null:this.props.message.id)}onMessageDelete(){this.props.deleteMessage(this.props.index)}onKeyPress(e){"Enter"===e.code&&!e.shiftKey&&this.contentsRef.current&&(this.props.editMessage(this.props.message.id,this.contentsRef.current.value),this.props.setEditedMessage(null))}onBlur(){this.contentsRef.current&&(this.props.editMessage(this.props.message.id,this.contentsRef.current.value),this.props.setEditedMessage(null))}onClickAuthor(e){const{x:t,y:n,height:r}=e.target.getBoundingClientRect();this.setState((e=>({authorMenuOpen:!e.authorMenuOpen,authorMenuX:t,authorMenuY:n+r})))}onReplaceAuthor(e){this.props.replaceMessageAuthor(this.props.message.id,e),this.setState({authorMenuOpen:!1})}onDismissAuthorMenu(){this.setState({authorMenuOpen:!1})}componentDidUpdate(e){e.editedMessageID!==e.message.id&&this.props.editedMessageID===this.props.message.id&&this.contentsRef.current&&this.contentsRef.current.focus()}render(){const{message:e,chars:t,editedMessageID:n,elemRef:r}=this.props,{id:o,authorID:s,contents:i}=e,a=o===n,c=t.find((e=>e.id===s))||{color:16777215,name:"Unknown Character"};return xe("div",{className:fe.message,ref:r},xe("div",{className:fe.author,style:`color: ${O(c.color)}`,onClick:this.onClickAuthor},c.name),xe("div",{className:S()(fe.contents,{[fe.editable]:a})},a?xe("div",{className:fe.messageEditWrapper},xe("textarea",{className:fe.messageEditArea,onKeyPress:this.onKeyPress,onBlur:this.onBlur,tabIndex:0,ref:this.contentsRef,value:i})):i),xe("div",{className:fe.buttons},xe("div",{className:S()(b,C,E),title:"Insert above",onClick:this.onInsertAbove}),xe("div",{className:S()(b,C,D),title:"Edit",onClick:this.onMessageEdit}),xe("div",{className:S()(b,C,I),title:"Delete",onClick:this.onMessageDelete})),this.state.authorMenuOpen?xe(be,{items:this.props.chars.map((({id:e,name:t})=>({id:e,value:t}))),x:this.state.authorMenuX,y:this.state.authorMenuY,onDismiss:this.onDismissAuthorMenu,onClickItem:this.onReplaceAuthor}):null)}});var Ee=e(609).h;const je={setInsertAboveMessageID:Ce};const ke=_("insertAboveMessageID",je)(class extends n.Component{constructor(e){super(e),this.lastMessageElem=(0,n.createRef)()}componentDidUpdate(e){e.messages&&this.props.messages&&e.messages.length+1===this.props.messages.length&&e.messages[e.messages.length-1]!==this.props.messages[this.props.messages.length-1]&&this.lastMessageElem.current&&this.lastMessageElem.current.scrollIntoView()}render(){const{messages:e,insertAboveMessageID:t,setInsertAboveMessageID:n}=this.props,r=[];if(e)for(let o=0;o<e.length;o++){const s=e[o];t===s.id&&r.push(Ee("div",{className:ue},Ee("div",{className:he},Ee("div",{className:pe},Ee("div",{className:S()(b,C,I),title:"Close",onClick:()=>n(null)}))),Ee("div",{className:de},Ee(g,{beforeMessage:o})))),r.push(Ee(De,{message:s,key:s.id,index:o,elemRef:o===e.length-1?this.lastMessageElem:void 0}))}return Ee("div",{className:ce},Ee("div",{className:le},r))}}),Ne="modal-bg__m0HV5",we="modal-positioner__JC0aj",Se="modal__ulBpF";var Ae=e(609).h,Pe=e(609).Fragment;const Me=({onClose:e,children:t})=>Ae(Pe,null,Ae("div",{className:Ne,onClick:e}),Ae("div",{className:we},Ae("div",{className:Se},t))),Oe={"project-bar":"project-bar__jqnP4",projectBar:"project-bar__jqnP4","project-name":"project-name__uuERj",projectName:"project-name__uuERj",button:"button__MAT5s",error:"error__vb_Q8"};var Te=e(454);const Re={properties:{version:{type:"uint32"},projectName:{type:"string"},convos:{elements:{properties:{messages:{elements:{properties:{authorID:{type:"string"},contents:{type:"string"},id:{type:"string"}}}},id:{type:"string"},name:{type:"string"}}}},chars:{elements:{properties:{id:{type:"string"},name:{type:"string"},color:{type:"uint32"}}}}}};var Fe=e(609).h;const Be={loadState:(e,t)=>({projectName:t.projectName,convos:t.convos,chars:t.chars}),setProjectName:(e,t)=>({projectName:t})};const Le=_(["version","projectName","convos","chars"],Be)(class extends n.Component{constructor(e){super(e),this.state={error:null},this.onInput=this.onInput.bind(this),this.onSave=this.onSave.bind(this),this.onLoad=this.onLoad.bind(this),this.closeError=this.closeError.bind(this)}onInput(e){this.props.setProjectName(e.target.value)}onLoad(){const e=document.createElement("input");e.type="file",e.addEventListener("change",(e=>{const t=e.target.files;if(t?.length){const e=new FileReader;e.addEventListener("load",(()=>{try{const t=JSON.parse(e.result);if((0,Te.validate)(Re,t).length>0)throw new Error("Invalid JSON");this.props.loadState(t)}catch(e){this.setState({error:e})}})),e.readAsText(t[0])}})),e.click()}onSave(){const{version:e,projectName:t,convos:n,chars:r}=this.props;oe(`${t}.json`,(({projectName:e,version:t,convos:n,chars:r})=>JSON.stringify({projectName:e,version:t,convos:n,chars:r}))({version:e,projectName:t,convos:n,chars:r}))}closeError(){this.setState({error:null})}render(){return Fe("div",{className:Oe.projectBar},Fe("input",{className:Oe.projectName,type:"text",value:this.props.projectName,onInput:this.onInput}),Fe("div",{className:S()(Oe.button,b,C,k),title:"Save",onClick:this.onSave}),Fe("div",{className:S()(Oe.button,b,C,j),title:"Load",onClick:this.onLoad}),this.state.error?Fe("div",{className:Oe.error},Fe("span",{className:Oe.errorMessage},this.state.error.message),Fe("div",{className:S()(b,C,I),onClick:this.closeError})):null)}}),Ue={row:"row__etbb0",label:"label__wCXFO"};var We=e(609).h;const ze={replaceCharacter:(e,t,n)=>({convos:e.convos.map((e=>({...e,messages:e.messages.map((e=>e.authorID!==t?e:{...e,authorID:n}))})))}),setToBeReplacedCharacterID:M,deleteCharacter:A};const Je=_(["chars","toBeReplacedCharID"],ze)(class extends n.Component{constructor(e){super(e),this.state={selectedCharacterID:null},this.selectCharacter=this.selectCharacter.bind(this),this.replaceCharacter=this.replaceCharacter.bind(this)}selectCharacter(e){this.setState({selectedCharacterID:e.target.value})}replaceCharacter(){this.props.toBeReplacedCharID&&this.state.selectedCharacterID&&(this.props.replaceCharacter(this.props.toBeReplacedCharID,this.state.selectedCharacterID),this.props.deleteCharacter(this.props.toBeReplacedCharID,this.state.selectedCharacterID),this.props.setToBeReplacedCharacterID(null))}render(){const{chars:e,toBeReplacedCharID:t}=this.props;return We("div",{className:Ue.replaceCharacter},We("div",{className:Ue.row},We("div",{className:Ue.label},"Replace character ",We("span",{className:Ue.oldCharacterName}," with:")),We("select",{onChange:this.selectCharacter,value:this.state.selectedCharacterID??void 0},e.map((e=>e.id===t?null:We("option",{value:e.id},e.name))))),We("div",null,We("button",{onClick:this.replaceCharacter,disabled:null===this.state.selectedCharacterID},"Replace")))}});var Ke=e(609).h;const $e={setEditedCharacterID:P,setToBeReplacedCharacterID:M,setExportedConvoID:Z};const He=_(["convos","currentConvoIndex","editedCharID","toBeReplacedCharID","exportedConvoID"],$e)(class extends n.Component{constructor(e){super(e),this.closeCharacterSettings=this.closeCharacterSettings.bind(this),this.closeCharacterReplaceDialog=this.closeCharacterReplaceDialog.bind(this),this.closeExportConvoDialog=this.closeExportConvoDialog.bind(this)}closeCharacterSettings(){this.props.setEditedCharacterID(null)}closeCharacterReplaceDialog(){this.props.setToBeReplacedCharacterID(null)}closeExportConvoDialog(){this.props.setExportedConvoID(null)}render(){const{convos:e,currentConvoIndex:t,editedCharID:n,toBeReplacedCharID:r,exportedConvoID:s}=this.props;return Ke("div",{className:o.app},Ke("div",{className:o.projectBarPane},Ke(Le,null)),Ke("div",{className:o.appPane},Ke("div",{className:o.convosPane},Ke(ne,null)),Ke("div",{className:o.messagesPane},Ke(ke,{messages:-1!==t?e[t].messages:null}),Ke("div",{className:o.commandBoxPane},Ke(g,null))),Ke("div",{className:o.charactersPane},Ke(L,null))),null!==n?Ke(Me,{onClose:this.closeCharacterSettings},Ke(H,null)):null,null!==r?Ke(Me,{onClose:this.closeCharacterReplaceDialog},Ke(Je,null)):null,null!==s?Ke(Me,{onClose:this.closeExportConvoDialog},Ke(ae,null)):null)}});var Ve=e(609).h;(0,n.render)(Ve((()=>Ve(r.z,{store:f},Ve(He,null))),null),document.body)})()})();
//# sourceMappingURL=main.d797c.js.map